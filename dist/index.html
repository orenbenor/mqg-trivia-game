<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="משחק טריוויה חינוכי בעברית על פעילות עדכנית של התנועה לאיכות השלטון."
    />
    <meta name="theme-color" content="#0A3A6E" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="טריוויה - התנועה לאיכות השלטון" />
    <meta
      property="og:description"
      content="משחק טריוויה חינוכי, עדכני ומהיר, עם הסברים ומקורות."
    />
    <meta property="og:image" content="assets/icons/icon.svg" />
    <meta property="og:locale" content="he_IL" />
    <meta name="twitter:card" content="summary_large_image" />
    <title>טריוויה - התנועה לאיכות השלטון</title>
    <link rel="icon" type="image/svg+xml" href="assets/icons/icon.svg" />
    <link rel="apple-touch-icon" href="assets/icons/icon.svg" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="back-glow glow-a"></div>
    <div class="back-glow glow-b"></div>
    <div id="appUpdateBanner" class="app-update-banner hidden">
      <p class="app-update-text">יש גרסה חדשה של המשחק. מומלץ לרענן כדי לקבל את כל העדכונים.</p>
      <div class="actions-row compact">
        <button id="appUpdateReloadBtn" class="secondary-btn" type="button">רענן לגרסה החדשה</button>
        <button id="appUpdateDismissBtn" class="ghost-btn" type="button">סגור</button>
      </div>
    </div>

    <main class="app-shell">
      <header class="brand-header">
        <div class="brand-mark" aria-hidden="true">
          <img
            class="official-logo"
            src="https://mqg.org.il/wp-content/uploads/2024/02/MQG-FULL-HORIZONTAL-LOGO-white-.png"
            alt="MQG in Israel"
            loading="lazy"
          />
        </div>
        <div>
          <p class="eyebrow">משחק לימודי פנימי</p>
          <h1>התנועה לאיכות השלטון - טריוויה 2025+</h1>
          <p class="subtitle">
            המשחק מתמקד בפעילות ובהצלחות עדכניות. בכל שאלה יש הסבר וקישור למקור.
          </p>
        </div>
      </header>

      <section id="screenLanding" class="panel screen active">
        <h2>איך תרצה להיכנס?</h2>
        <p class="muted">שלב 1: בחר מסלול עבודה.</p>
        <div class="entry-grid entry-department-grid">
          <article id="entryTelemarketingCard" class="entry-card">
            <h3>טלמרקטינג</h3>
            <p>משחק מהיר, משחק מהיר עונתי, ומשחק ייעודי על פי פעילות.</p>
            <button id="chooseTelemarketingBtn" class="primary-btn">בחר טלמרקטינג</button>
          </article>

          <article id="entryEducationCard" class="entry-card">
            <h3>אגף חינוך</h3>
            <p>משחק מהיר ייעודי לאגף החינוך עם בנק שאלות נפרד.</p>
            <button id="chooseEducationBtn" class="secondary-btn">בחר אגף חינוך</button>
          </article>
        </div>

        <p id="entryDepartmentState" class="muted tight"></p>
        <p id="entryDepartmentMsg" class="form-msg hidden"></p>

        <div id="entryModesWrap" class="hidden">
          <p class="muted">שלב 2: בחר סוג משחק.</p>
          <div class="entry-grid">
            <article class="entry-card">
              <h3>משחק מהיר</h3>
              <p>התחלת משחק תוך שניות: שם שחקן, ניקוד ומעקב ביצועים.</p>
              <button id="goQuickBtn" class="primary-btn">למשחק מהיר</button>
            </article>

            <article id="entrySeasonalCard" class="entry-card">
              <h3>משחק מהיר עונתי</h3>
              <p>שאלות ממוקדות על פעילות התנועה מאוקטובר 2025 ומעלה בלבד.</p>
              <button id="goSeasonalQuickBtn" class="secondary-btn">למשחק מהיר עונתי</button>
            </article>

            <article id="entryActivityCard" class="entry-card">
              <h3>משחק על פי פעילות</h3>
              <p>בחירת נושא פעילות ממוקד עם 30 שאלות ייעודיות לכל נושא.</p>
              <button id="goActivityQuickBtn" class="secondary-btn">למשחק על פי פעילות</button>
            </article>
          </div>
        </div>

        <div class="entry-grid">
          <article class="entry-card admin-entry">
            <h3>כניסת מנהל</h3>
            <p>מעקב אחרי שחקנים, הוספת פעילויות, יצירת שאלות לאישור ועדכון המאגר.</p>
            <button id="goAdminBtn" class="secondary-btn">כניסת מנהל</button>
          </article>
        </div>
      </section>

      <section id="screenQuickSetup" class="panel screen hidden">
        <h2 id="quickSetupTitle">משחק מהיר</h2>
        <p id="quickModeNote" class="muted tight"></p>
        <div class="form-grid">
          <label class="field">
            <span>מה שמך?</span>
            <input id="playerNameInput" type="text" maxlength="40" placeholder="למשל: רוני" />
          </label>

          <label class="field">
            <span>כמות שאלות</span>
            <select id="questionCountSelect">
              <option value="3">3</option>
              <option value="10">10</option>
              <option value="15" selected>15</option>
              <option value="20">20</option>
              <option value="30">30</option>
              <option value="all">כל המאגר</option>
            </select>
          </label>

          <label id="activityTopicField" class="field hidden">
            <span>בחר נושא פעילות</span>
            <select id="activityTopicSelect">
              <option value="oct7" selected>הקמת ועדת חקירה ממלכתית על השביעי באוקטובר</option>
              <option value="burden">שוויון בנטל</option>
              <option value="judicial">ההפיכה המשפטית</option>
            </select>
          </label>

          <label class="field checkbox-field">
            <input id="showLearningToggle" type="checkbox" checked />
            <span>להציג "כרטיס למידה" לפני כל שאלה</span>
          </label>
        </div>

        <div class="actions-row">
          <button id="startQuickBtn" class="primary-btn">התחל משחק</button>
          <button data-go="landing" class="ghost-btn">חזרה</button>
        </div>
        <p id="quickSetupError" class="error-text hidden"></p>
      </section>

      <section id="screenAdminLogin" class="panel screen hidden">
        <h2>כניסת מנהל</h2>
        <p class="muted">התחברות מאובטחת דרך שרת המערכת.</p>
        <div class="form-grid compact">
          <label class="field">
            <span>שם משתמש</span>
            <input id="adminUsernameInput" type="text" maxlength="40" placeholder="הקלד שם משתמש" />
          </label>
          <label class="field">
            <span>סיסמה</span>
            <input id="adminPasswordInput" type="password" maxlength="80" placeholder="הקלד סיסמה" />
          </label>
        </div>
        <div class="actions-row">
          <button id="loginAdminBtn" class="primary-btn">כניסה</button>
          <button data-go="landing" class="ghost-btn">חזרה</button>
        </div>
        <p id="adminLoginError" class="error-text hidden"></p>
      </section>

      <section id="screenQuiz" class="panel screen hidden">
        <div class="quiz-top">
          <p id="quizPlayerName" class="pill"></p>
          <p id="quizProgress" class="pill"></p>
          <p id="quizScore" class="pill"></p>
          <div id="timerWrap" class="timer-wrap">
            <div id="hourglassIcon" class="hourglass" aria-hidden="true"></div>
            <div class="timer-text-wrap">
              <p class="timer-label">זמן לשאלה</p>
              <p id="timerText" class="timer-text">30</p>
            </div>
          </div>
        </div>

        <div class="quiz-tools">
          <button id="resetQuestionCyclesPublicBtn" class="ghost-btn" type="button">
            אתחל וערבב שאלות מחדש
          </button>
          <p id="questionCycleResetMsg" class="form-msg hidden"></p>
        </div>

        <div class="progress-track" aria-hidden="true">
          <div id="quizProgressFill" class="progress-fill"></div>
        </div>

        <article class="question-card">
          <div class="question-hero">
            <img id="questionBanner" class="question-banner" alt="באנר שאלה" />
            <div class="question-overlay"></div>
            <h2 id="questionTitle" class="question-title in-hero"></h2>
          </div>

          <p id="questionLearn" class="learn-box"></p>

          <div id="optionsWrap" class="options-wrap"></div>

          <section id="feedbackCard" class="feedback-card hidden">
            <h3 id="feedbackHeadline"></h3>
            <p id="feedbackText"></p>
            <ul id="feedbackWrongReasons" class="feedback-reasons"></ul>
            <button id="feedbackDeepExplainBtn" type="button" class="ghost-btn">הסבר יותר לעומק</button>
            <ul id="feedbackDeepReasons" class="feedback-reasons deep-reasons hidden"></ul>
            <ul id="feedbackSources" class="sources-list"></ul>
            <button id="nextQuestionBtn" class="primary-btn">לשאלה הבאה</button>
          </section>
        </article>
      </section>

      <section id="screenResult" class="panel screen hidden">
        <h2>סיכום</h2>
        <p id="resultMain" class="result-main"></p>
        <p id="resultSub" class="muted"></p>

        <div id="wrongAnswersWrap" class="wrong-answers"></div>

        <div class="actions-row">
          <button id="playAgainBtn" class="primary-btn">משחק נוסף</button>
          <button data-go="landing" class="secondary-btn">חזרה למסך הראשי</button>
        </div>
      </section>

      <section id="screenAdminPanel" class="panel screen hidden">
        <div class="admin-head">
          <div>
            <h2>לוח מנהל</h2>
            <p class="muted">ניהול מאגר, ניהול מנהלים, הוספת תוכן חדש ומעקב תוצאות שחקנים.</p>
          </div>
          <div class="actions-row compact">
            <button id="openQuestionBankBtn" class="secondary-btn" type="button">מאגר שאלות</button>
            <button id="openAdminManagersBtn" class="ghost-btn" type="button">ניהול מנהלים</button>
            <button id="backToAdminMainBtn" class="ghost-btn hidden" type="button">חזרה ללוח המנהל</button>
            <button id="adminLogoutBtn" class="ghost-btn">התנתקות</button>
          </div>
        </div>

        <div class="admin-tabs" role="tablist" aria-label="ניווט מנהל">
          <button
            class="admin-tab-btn active"
            type="button"
            role="tab"
            aria-selected="true"
            data-admin-tab-target="dashboard"
          >
            דשבורד
          </button>
          <button
            class="admin-tab-btn"
            type="button"
            role="tab"
            aria-selected="false"
            data-admin-tab-target="inbox"
          >
            הודעות נכנסות
            <span id="adminInboxBadge" class="admin-tab-count hidden">0</span>
          </button>
          <button
            class="admin-tab-btn"
            type="button"
            role="tab"
            aria-selected="false"
            data-admin-tab-target="content"
          >
            הוסף תוכן חדש
          </button>
          <button
            class="admin-tab-btn"
            type="button"
            role="tab"
            aria-selected="false"
            data-admin-tab-target="questionBank"
          >
            מאגר שאלות
          </button>
          <button
            class="admin-tab-btn"
            type="button"
            role="tab"
            aria-selected="false"
            data-admin-tab-target="learning"
          >
            מעקב תוצאות שחקנים
          </button>
          <button
            class="admin-tab-btn"
            type="button"
            role="tab"
            aria-selected="false"
            data-admin-tab-target="security"
          >
            ניהול מנהלים
          </button>
        </div>

        <div id="adminMainSections">
          <section
            class="admin-tab-panel"
            data-admin-tab-panel="dashboard"
            role="tabpanel"
            aria-hidden="false"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>בדיקת מערכת</h3>
                <button id="adminSystemCheckBtn" type="button" class="ghost-btn">בדוק עכשיו</button>
              </div>
              <p id="adminSystemCheckStatus" class="muted tight">
                בדיקה מהירה של backend, session ותצורת חיבור.
              </p>
              <div id="adminSystemCheckRows" class="cards-list admin-check-list"></div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>תמונת מצב</h3>
                <p class="muted tight">סקירה מהירה של נתוני המערכת, תוכן ולמידה.</p>
              </div>
              <div class="stats-grid" id="adminStats"></div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>פעולות מהירות</h3>
                <p class="muted tight">מעבר מהיר לאזורים המרכזיים בלוח הניהול.</p>
              </div>
              <div class="actions-row">
                <button type="button" class="secondary-btn" data-admin-jump-tab="content">
                  הוסף תוכן חדש
                </button>
                <button type="button" class="ghost-btn" data-admin-jump-tab="questionBank">
                  מעבר למאגר השאלות
                </button>
                <button type="button" class="ghost-btn" data-admin-jump-tab="learning">
                  מעקב תוצאות שחקנים
                </button>
              </div>
            </section>
          </section>

          <section
            class="admin-tab-panel hidden"
            data-admin-tab-panel="inbox"
            role="tabpanel"
            aria-hidden="true"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>הודעות נכנסות</h3>
                <div class="inline-actions">
                  <button id="adminInboxMarkAllSeenBtn" type="button" class="ghost-btn">סמן הכל כנצפה</button>
                </div>
              </div>
              <p id="adminInboxSummary" class="muted tight"></p>
              <p id="adminInboxMsg" class="form-msg hidden"></p>
              <div id="adminInboxList" class="cards-list"></div>
            </section>
          </section>

          <section
            class="admin-tab-panel hidden"
            data-admin-tab-panel="content"
            role="tabpanel"
            aria-hidden="true"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>הוסף תוכן חדש מטקסט חופשי</h3>
                <p class="muted tight">הדבק טקסט ולחץ Enter לניתוח אוטומטי, זיהוי נושא והצעת 10 שאלות.</p>
              </div>

              <div class="form-grid">
                <label class="field full">
                  <span>טקסט לניתוח</span>
                  <textarea
                    id="longTextInput"
                    rows="10"
                    placeholder="הדבק כאן טקסט חופשי. Enter ינתח את הטקסט ויציע 10 שאלות."
                  ></textarea>
                </label>

                <label class="field full">
                  <span>או העלאת קובץ טקסט</span>
                  <input id="longTextFileInput" type="file" accept=".txt,.md,.text" />
                </label>

                <label class="field">
                  <span>כמות שאלות ליצירה</span>
                  <select id="longTextQuestionCount">
                    <option value="5">5</option>
                    <option value="10" selected>10</option>
                    <option value="15">15</option>
                  </select>
                </label>

                <label class="field">
                  <span>קטגוריה לשאלות</span>
                  <select id="longTextCategory">
                    <option value="מערכת המשפט ומינויים">מערכת המשפט ומינויים</option>
                    <option value="שוויון בנטל">שוויון בנטל</option>
                    <option value="תקשורת ושקיפות">תקשורת ושקיפות</option>
                    <option value="כלכלה ותחרות">כלכלה ותחרות</option>
                    <option value="חברות ממשלתיות">חברות ממשלתיות</option>
                    <option value="חושפי שחיתות">חושפי שחיתות</option>
                    <option value="פעילות ציבורית">פעילות ציבורית</option>
                  </select>
                </label>

                <label class="field">
                  <span>סוג שאלות</span>
                  <select id="longTextKind">
                    <option value="activity" selected>פעילות</option>
                    <option value="success">הישג</option>
                  </select>
                </label>

                <label class="field">
                  <span>תאריך ייחוס</span>
                  <input id="longTextDate" type="date" />
                </label>

                <label class="field">
                  <span>שם מקור (אופציונלי)</span>
                  <input id="longTextSourceLabel" type="text" maxlength="120" placeholder="למשל: מסמך פנימי" />
                </label>

                <label class="field">
                  <span>קישור מקור (אופציונלי)</span>
                  <input id="longTextSourceUrl" type="url" placeholder="https://..." />
                </label>
              </div>

              <div class="actions-row">
                <button id="analyzeLongTextBtn" type="button" class="secondary-btn">נתח טקסט והצע 10 שאלות</button>
                <button id="generateLongTextDraftsBtn" type="button" class="primary-btn" disabled>רענן הצעת שאלות</button>
                <button id="approveAllTextDraftsBtn" type="button" class="ghost-btn" disabled>הוסף את כל השאלות למאגר</button>
              </div>
              <p id="longTextMsg" class="form-msg hidden"></p>
              <p id="longTextTopicTitle" class="muted tight hidden"></p>
              <div id="longTextDraftsPreview" class="cards-list"></div>
            </section>

            <section class="admin-section">
              <h3>הוספת פעילות / הישג</h3>
              <form id="activityForm" class="form-grid">
                <label class="field">
                  <span>כותרת</span>
                  <input name="title" type="text" required maxlength="140" placeholder="למשל: עתירה לבג״ץ בנושא..." />
                </label>

                <label class="field">
                  <span>תאריך</span>
                  <input name="date" type="date" required />
                </label>

                <label class="field">
                  <span>קטגוריה</span>
                  <select name="category">
                    <option value="מערכת המשפט ומינויים">מערכת המשפט ומינויים</option>
                    <option value="שוויון בנטל">שוויון בנטל</option>
                    <option value="תקשורת ושקיפות">תקשורת ושקיפות</option>
                    <option value="כלכלה ותחרות">כלכלה ותחרות</option>
                    <option value="חברות ממשלתיות">חברות ממשלתיות</option>
                    <option value="חושפי שחיתות">חושפי שחיתות</option>
                    <option value="פעילות ציבורית">פעילות ציבורית</option>
                  </select>
                </label>

                <label class="field">
                  <span>סוג</span>
                  <select name="kind">
                    <option value="success" selected>הישג</option>
                    <option value="activity">פעילות</option>
                  </select>
                </label>

                <label class="field full">
                  <span>רקע קצר</span>
                  <textarea name="context" rows="3" required placeholder="מה היה המהלך המרכזי?"></textarea>
                </label>

                <label class="field full">
                  <span>תוצאה / הישג בפועל</span>
                  <textarea name="outcome" rows="3" required placeholder="מה בפועל הושג או נקבע?"></textarea>
                </label>

                <label class="field">
                  <span>שם מקור</span>
                  <input name="sourceLabel" type="text" maxlength="120" placeholder="למשל: הודעת התנועה" />
                </label>

                <label class="field">
                  <span>קישור מקור</span>
                  <input name="sourceUrl" type="url" placeholder="https://..." />
                </label>

                <label class="field full">
                  <span>קבצים / תמונות (אופציונלי)</span>
                  <input id="adminFilesInput" name="files" type="file" multiple />
                </label>

                <div class="actions-row">
                  <button type="submit" class="primary-btn">שמור פעילות</button>
                </div>
              </form>
              <p id="activityFormMsg" class="form-msg hidden"></p>
            </section>

            <section class="admin-section">
              <h3>פעילויות שהוזנו</h3>
              <div id="activitiesList" class="cards-list"></div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>תור פרסום שאלות (Draft -> Review -> Published)</h3>
                <p id="draftQueueSummary" class="muted tight"></p>
              </div>
              <div class="form-grid draft-queue-tools">
                <label class="field">
                  <span>סטטוס</span>
                  <select id="draftQueueStatusFilter">
                    <option value="all" selected>הכול</option>
                    <option value="draft">Draft</option>
                    <option value="review">Review</option>
                  </select>
                </label>
                <label class="field">
                  <span>חיפוש טיוטה</span>
                  <input
                    id="draftQueueSearchInput"
                    type="text"
                    placeholder="חפש לפי שאלה / קטגוריה / הסבר / מקור"
                  />
                </label>
              </div>
              <div class="actions-row">
                <button id="selectVisibleDraftsBtn" type="button" class="ghost-btn">בחר הכל בתצוגה</button>
                <button id="clearDraftSelectionBtn" type="button" class="ghost-btn">נקה בחירה</button>
                <button id="moveDraftsToReviewBtn" type="button" class="secondary-btn">העבר ל-Review</button>
                <button id="moveDraftsToDraftBtn" type="button" class="ghost-btn">החזר ל-Draft</button>
                <button id="approveSelectedDraftsBtn" type="button" class="primary-btn">אשר נבחרות</button>
                <button id="rejectSelectedDraftsBtn" type="button" class="ghost-btn">דחה נבחרות</button>
                <button id="undoDraftActionBtn" type="button" class="ghost-btn">בטל פעולה אחרונה</button>
              </div>
              <p id="draftQueueMsg" class="form-msg hidden"></p>
              <div id="draftsList" class="cards-list"></div>
            </section>

            <section class="admin-section">
              <h3>שאלות שאושרו למאגר</h3>
              <div id="customQuestionsList" class="cards-list"></div>
            </section>
          </section>

          <section
            id="adminQuestionBankSection"
            class="admin-tab-panel hidden"
            data-admin-tab-panel="questionBank"
            role="tabpanel"
            aria-hidden="true"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>מאגר השאלות - עריכה וניהול</h3>
                <p id="questionCountExact" class="muted tight"></p>
              </div>
              <p class="muted">כאן ניתן לערוך, להסיר ולהחזיר שאלות באופן ממוקד.</p>
              <div class="form-grid question-tools">
                <label class="field full">
                  <span>חיפוש שאלה</span>
                  <input
                    id="questionSearchInput"
                    type="text"
                    placeholder="חפש לפי טקסט שאלה / קטגוריה / מקור"
                  />
                </label>
                <label class="field">
                  <span>קטגוריה</span>
                  <select id="questionCategoryFilter">
                    <option value="all" selected>כל הקטגוריות</option>
                    <option value="מערכת המשפט ומינויים">מערכת המשפט ומינויים</option>
                    <option value="שוויון בנטל">שוויון בנטל</option>
                    <option value="תקשורת ושקיפות">תקשורת ושקיפות</option>
                    <option value="כלכלה ותחרות">כלכלה ותחרות</option>
                    <option value="חברות ממשלתיות">חברות ממשלתיות</option>
                    <option value="חושפי שחיתות">חושפי שחיתות</option>
                    <option value="פעילות ציבורית">פעילות ציבורית</option>
                  </select>
                </label>
                <label class="field">
                  <span>סוג שאלה</span>
                  <select id="questionKindFilter">
                    <option value="all" selected>הכול</option>
                    <option value="activity">פעילות</option>
                    <option value="success">הישג</option>
                  </select>
                </label>
                <label class="field">
                  <span>סטטוס</span>
                  <select id="questionVisibilityFilter">
                    <option value="all" selected>הכול</option>
                    <option value="active">פעילה</option>
                    <option value="hidden">מוסתרת</option>
                    <option value="custom">מותאמת (Published)</option>
                    <option value="base">בסיס</option>
                  </select>
                </label>
                <label class="field">
                  <span>מקור</span>
                  <select id="questionSourceFilter">
                    <option value="all" selected>הכול</option>
                    <option value="with-source">עם מקור</option>
                    <option value="no-source">ללא מקור</option>
                  </select>
                </label>
                <label class="field">
                  <span>מתאריך</span>
                  <input id="questionDateFrom" type="date" />
                </label>
                <label class="field">
                  <span>עד תאריך</span>
                  <input id="questionDateTo" type="date" />
                </label>
                <label class="field">
                  <span>מיון</span>
                  <select id="questionSortMode">
                    <option value="default" selected>ברירת מחדל</option>
                    <option value="newest">הכי חדשות</option>
                    <option value="hardest">הכי מכשילות</option>
                    <option value="quality-risk">סיכון איכות גבוה</option>
                  </select>
                </label>
              </div>
              <div class="actions-row compact">
                <button id="resetQuestionFiltersBtn" class="ghost-btn" type="button">נקה פילטרים</button>
                <button id="runQuestionAuditBtn" class="secondary-btn" type="button">הרץ Audit לפני פרסום</button>
                <button id="clearQuestionAuditBtn" class="ghost-btn" type="button">נקה דוח Audit</button>
              </div>
              <p id="questionAuditStatus" class="form-msg hidden"></p>
              <div id="questionAuditResults" class="cards-list hidden"></div>
              <div id="allQuestionsList" class="cards-list"></div>
            </section>
          </section>

          <section
            class="admin-tab-panel hidden"
            data-admin-tab-panel="learning"
            role="tabpanel"
            aria-hidden="true"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>מעקב תוצאות שחקנים</h3>
                <div class="inline-actions">
                  <button id="exportAttemptsCsvBtn" class="ghost-btn" type="button">ייצוא תוצאות CSV</button>
                  <button id="exportHardestCsvBtn" class="ghost-btn" type="button">ייצוא שאלות מכשילות CSV</button>
                  <button id="clearAttemptsBtn" class="ghost-btn">ניקוי נתונים</button>
                </div>
              </div>
              <p id="learningInsightsSummary" class="muted tight"></p>
              <div class="form-grid question-tools">
                <label class="field">
                  <span>מדגם מינימלי להתראות</span>
                  <input id="learningAlertMinAttempts" type="number" min="1" max="50" step="1" />
                </label>
                <label class="field">
                  <span>דיוק נושא - התראת מעקב (%)</span>
                  <input id="learningAlertCategoryWarn" type="number" min="0" max="100" step="1" />
                </label>
                <label class="field">
                  <span>דיוק נושא - התראה גבוהה (%)</span>
                  <input id="learningAlertCategoryHigh" type="number" min="0" max="100" step="1" />
                </label>
                <label class="field">
                  <span>פקיעות זמן נושא - התראה (%)</span>
                  <input id="learningAlertCategoryTimeoutWarn" type="number" min="0" max="100" step="1" />
                </label>
                <label class="field">
                  <span>נפילות שאלה - התראת מעקב (%)</span>
                  <input id="learningAlertQuestionFailWarn" type="number" min="0" max="100" step="1" />
                </label>
                <label class="field">
                  <span>נפילות שאלה - התראה גבוהה (%)</span>
                  <input id="learningAlertQuestionFailHigh" type="number" min="0" max="100" step="1" />
                </label>
                <label class="field">
                  <span>פקיעות זמן שאלה - התראה (%)</span>
                  <input id="learningAlertQuestionTimeoutWarn" type="number" min="0" max="100" step="1" />
                </label>
              </div>
              <div class="actions-row compact">
                <button id="saveLearningAlertSettingsBtn" class="secondary-btn" type="button">שמור רגישות התראות</button>
                <button id="resetLearningAlertSettingsBtn" class="ghost-btn" type="button">איפוס ברירת מחדל</button>
              </div>
              <p id="learningAlertSettingsMsg" class="form-msg hidden"></p>
              <div id="learningAlertsList" class="cards-list learning-alert-list"></div>
              <div class="table-wrap">
                <table>
                  <thead>
                    <tr>
                      <th>שחקן</th>
                      <th>ניקוד</th>
                      <th>אחוז</th>
                      <th>זמן</th>
                      <th>תאריך</th>
                    </tr>
                  </thead>
                  <tbody id="attemptsTableBody"></tbody>
                </table>
              </div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>מדד למידה לפי נושא</h3>
                <p class="muted tight">איפה שחקנים נופלים ולמה כדאי לחזק.</p>
              </div>
              <div id="learningMetricsList" class="cards-list"></div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>שאלות מכשילות ביותר</h3>
                <p class="muted tight">זיהוי שאלות עם אחוז נפילה גבוה ופקיעות זמן.</p>
              </div>
              <div id="questionDifficultyList" class="cards-list"></div>
            </section>

            <section class="admin-section">
              <div class="section-head">
                <h3>המלצות פעולה אוטומטיות</h3>
                <p class="muted tight">צעדים ממוקדים לשיפור למידה ותוכן.</p>
              </div>
              <div id="learningRecommendationsList" class="cards-list"></div>
            </section>
          </section>

          <section
            class="admin-tab-panel hidden"
            data-admin-tab-panel="security"
            role="tabpanel"
            aria-hidden="true"
          >
            <section class="admin-section admin-section-first">
              <div class="section-head">
                <h3>ניהול מנהלים</h3>
                <p id="adminSessionInfo" class="muted tight"></p>
              </div>

              <form id="adminUserForm" class="form-grid">
                <label class="field">
                  <span>שם משתמש חדש</span>
                  <input id="adminUserNewUsername" type="text" maxlength="40" placeholder="למשל: נועה" />
                </label>
                <label class="field">
                  <span>סיסמה חדשה</span>
                  <input id="adminUserNewPassword" type="password" maxlength="80" placeholder="לפחות 8 תווים" />
                </label>
                <div class="actions-row">
                  <button id="createAdminUserBtn" type="submit" class="primary-btn">צור מנהל חדש</button>
                </div>
              </form>
              <p id="adminUserFormMsg" class="form-msg hidden"></p>

              <form id="adminPasswordForm" class="form-grid">
                <label class="field">
                  <span>סיסמה נוכחית</span>
                  <input id="adminCurrentPassword" type="password" maxlength="100" placeholder="הזן סיסמה נוכחית" />
                </label>
                <label class="field">
                  <span>סיסמה חדשה</span>
                  <input id="adminNewPassword" type="password" maxlength="100" placeholder="לפחות 8 תווים" />
                </label>
                <label class="field">
                  <span>אימות סיסמה חדשה</span>
                  <input id="adminConfirmPassword" type="password" maxlength="100" placeholder="הזן שוב את הסיסמה החדשה" />
                </label>
                <div class="actions-row">
                  <button id="changeOwnPasswordBtn" type="submit" class="ghost-btn">עדכן את הסיסמה שלי</button>
                </div>
              </form>
              <p id="adminPasswordFormMsg" class="form-msg hidden"></p>
              <div id="adminUsersList" class="cards-list"></div>
            </section>
          </section>
        </div>
      </section>

      <footer class="footer-note">
        <p>מקורות הבסיס עודכנו לתוכן 2025 ומעלה (נכון ל־6 בפברואר 2026).</p>
      </footer>
    </main>

    <div id="questionEditModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="questionEditTitle">
      <div class="modal-card">
        <div class="section-head">
          <h3 id="questionEditTitle">עריכת שאלה</h3>
          <button id="questionEditCloseBtn" type="button" class="ghost-btn">סגור</button>
        </div>
        <form id="questionEditForm" class="form-grid">
          <label class="field full">
            <span>נוסח השאלה</span>
            <textarea id="questionEditQuestionInput" rows="3" required></textarea>
          </label>
          <label class="field full">
            <span>רקע קצר</span>
            <textarea id="questionEditLearnInput" rows="3"></textarea>
          </label>
          <label class="field full">
            <span>הסבר תשובה</span>
            <textarea id="questionEditExplanationInput" rows="3"></textarea>
          </label>
          <div class="field full">
            <span>אפשרויות תשובה</span>
            <div id="questionEditOptionsWrap" class="modal-options-grid"></div>
          </div>
          <label class="field">
            <span>תשובה נכונה</span>
            <select id="questionEditAnswerSelect"></select>
          </label>
          <div class="actions-row">
            <button id="questionEditSaveBtn" type="submit" class="primary-btn">שמור שינויים</button>
            <button id="questionEditCancelBtn" type="button" class="ghost-btn">ביטול</button>
          </div>
        </form>
        <p id="questionEditMsg" class="form-msg hidden"></p>
      </div>
    </div>

    <div class="always-actions">
      <button id="newGameAnytimeBtn" class="secondary-btn" type="button">משחק חדש בכל שלב</button>
      <button id="homeAnytimeBtn" class="ghost-btn" type="button">מסך הבית</button>
      <button id="reportIssueAnytimeBtn" class="ghost-btn" type="button">דווח על תקלה</button>
    </div>

    <audio id="bgMusic" loop preload="auto">
      <source src="assets/audio/mqg-theme.mp3" type="audio/mpeg" />
    </audio>

    <div id="musicControls" class="music-controls">
      <p class="music-title">מוזיקת רקע</p>
      <div class="music-row">
        <button id="musicDownBtn" class="ghost-btn mini-btn" type="button">-</button>
        <button id="musicMuteBtn" class="secondary-btn mini-btn" type="button">השתק</button>
        <button id="musicUpBtn" class="ghost-btn mini-btn" type="button">+</button>
      </div>
      <p id="musicLevelText" class="music-level">עוצמה: 12%</p>
    </div>

    <div
      id="reportIssueModal"
      class="modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="reportIssueTitle"
    >
      <div class="modal-card">
        <div class="section-head">
          <h3 id="reportIssueTitle">דווח על תקלה</h3>
          <button id="reportIssueCloseBtn" type="button" class="ghost-btn">סגור</button>
        </div>
        <form id="reportIssueForm" class="form-grid">
          <label class="field full">
            <span>מה הבעיה?</span>
            <textarea
              id="reportIssueTextInput"
              rows="5"
              maxlength="1200"
              placeholder="תאר מה לא עובד, באיזה שלב, ומה ציפית שיקרה."
              required
            ></textarea>
          </label>
          <label class="field">
            <span>שם (אופציונלי)</span>
            <input id="reportIssueNameInput" type="text" maxlength="60" placeholder="אפשר להשאיר ריק" />
          </label>
          <div class="actions-row">
            <button id="reportIssueSubmitBtn" type="submit" class="primary-btn">שלח דיווח</button>
            <button id="reportIssueCancelBtn" type="button" class="ghost-btn">ביטול</button>
          </div>
        </form>
        <p id="reportIssueMsg" class="form-msg hidden"></p>
      </div>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js")
            .then((registration) => {
              const notifyUpdate = (worker) => {
                window.dispatchEvent(
                  new CustomEvent("mqg-sw-update-ready", {
                    detail: { worker: worker || null },
                  }),
                );
              };

              if (registration.waiting) {
                notifyUpdate(registration.waiting);
              }

              registration.addEventListener("updatefound", () => {
                const installing = registration.installing;
                if (!installing) {
                  return;
                }
                installing.addEventListener("statechange", () => {
                  if (installing.state === "installed" && navigator.serviceWorker.controller) {
                    notifyUpdate(registration.waiting || installing);
                  }
                });
              });
            })
            .catch(() => {});
        });
      }
    </script>
  </body>
</html>
